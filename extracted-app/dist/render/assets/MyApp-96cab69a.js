import{a2 as V,aq as ue,ca as de,ah as M,cb as ce,am as A,aL as N,a8 as O,a9 as j,I as E,H as _e,ad as fe,G as ye,cc as ge,aX as we,cd as be,ce as Ae,cf as he,cg as ve,a1 as xe,a7 as ke}from"./main-8b08e1d6.js";import I from"./ModalConfirm-92ee844f.js";import{_ as Ce}from"./InputSearch.vue_vue_type_script_setup_true_lang-d786940a.js";import{_ as Me}from"./DataTable.vue_vue_type_style_index_0_lang-cdaf49f4.js";import{M as Be}from"./Modal-0f4a5102.js";import{a as q}from"./useMyApps-6a511b1e.js";import{_ as Pe}from"./InputGroup-20db4544.js";import{_ as $e}from"./DatePicker-91499e1f.js";import{d as X,w as Se,S as L,X as G,Y as o,D as t,u as e,E as _,$ as l,t as De,b as Ne,r as Le,f as Te,a4 as Ue,U as Re,V as p,q as z,a8 as Ke,a2 as Fe,F as Ee,a1 as Ie}from"./_plugin-vue_export-helper-b059e461.js";import{_ as H}from"./Input-96fa4693.js";import{_ as Y}from"./FormItem-52ed65a1.js";import"./lodash-6114c6d4.js";import"./axios-1e30d922.js";import"./xlsx-f5126985.js";import"./Divider-65f3d898.js";import"./DataTable-e5054828.js";import"./Checkbox-ce86da58.js";import"./RadioGroup-69a7fbba.js";import"./Radio-c980589e.js";import"./Suffix-fc59bb7a.js";import"./Select-f7c79767.js";import"./Pagination-ce77c3f3.js";import"./useScriptEditor-4173e447.js";import"./a-72358bba.js";const ze=X({__name:"ExportModal",setup(J){const{t:n}=V(),{exportAppState:u,showModal:y}=q(),{dayjs:i,now:c}=ue(),v={"Next day":i(c.value).add(1,"day").toDate().getTime(),"Next week":i(c.value).add(7,"day").toDate().getTime(),"Next month":i(c.value).add(1,"month").toDate().getTime(),"Next year":i(c.value).add(1,"year").toDate().getTime()};Se(()=>y.exportAppByKey,d=>{d&&(u.key=de(25),u.expiredAt=c.value.getTime())});const g=async()=>{const{data:d}=await ce(De(u));d&&(y.exportAppByKey=!1,window.$message.success("App exported!"))},B=async()=>{await navigator.clipboard.writeText(u.key),window.$message.success("Copied!")};return(d,r)=>{const h=H,x=A,P=Pe,k=Y,$=$e,w=N,S=O,D=j;return L(),G(D,{show:e(y).exportAppByKey,"onUpdate:show":r[2]||(r[2]=f=>e(y).exportAppByKey=f)},{default:o(()=>[t(S,{title:"Export",class:"min-h-380px w-70vh",bordered:!1,size:"huge"},{default:o(()=>[t(w,{vertical:""},{default:o(()=>[t(k,{label:e(n)("Common.Label.Key")},{default:o(()=>[t(P,null,{default:o(()=>[t(h,{value:e(u).key,"onUpdate:value":r[0]||(r[0]=f=>e(u).key=f)},null,8,["value"]),t(x,{type:"success",onClick:B},{icon:o(()=>[t(M,{type:"copy"})]),_:1})]),_:1})]),_:1},8,["label"]),t(k,{label:e(n)("Page.AutomationApps.Label.ExpiredAt")},{default:o(()=>[t($,{value:e(u).expiredAt,"onUpdate:value":r[1]||(r[1]=f=>e(u).expiredAt=f),type:"datetime",clearable:"",shortcuts:v},null,8,["value"])]),_:1},8,["label"]),t(x,{type:"primary",size:"large",onClick:g},{default:o(()=>[_(l(e(n)("Page.AutomationApps.Button.Export")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])}}}),Ve={class:"flex items-center gap-8px pt-8px pb-16px"},Oe={class:"app-number"},je={class:"flex items-center gap-8px pt-8px pb-16px"},qe={class:"app-number"},Xe={class:"flex items-center gap-16px"},Ge={class:"flex items-center gap-8px"},He={class:"flex items-center gap-8px"},Ye={class:"mt-4"},Je={class:"table-header flex items-center gap-16px"},Qe={class:"flex gap-2"},We=X({__name:"MyApp",setup(J){const{t:n}=V();E(_e());const{isDarkMode:u}=E(fe()),{router:y}=ye(),{state:i,activeTab:c,stats:v,defaultParams:g,pagination:B,showModal:d,selectedApps:r,selectedApp:h,loading:x,apps:P,columns:k,rowProps:$,fetchApps:w,debounceFetchApps:S,deleteApp:D,deleteMultiApps:f,onPageUpdate:Q,onPageSizeUpdate:W,onSortChange:Z,importApp:ee,createApp:Ze}=q(),te=async()=>{y.push({params:{id:ge()},name:"main.scriptEditor"})},ae=async()=>{if(!h.value)return;const{data:b}=await we(h.value.id),a=b.data;a.name=i.newName,a.script.name=i.newName,await be(a),await w(),i.newName="",i.showRenameModal=!1,window.$message.success(n("Page.AutomationApps.Msg.AppRenamed"))},T=Ne(null),m=Le({show:!1,key:"",data:null,path:""}),U=()=>{Object.assign(m,{show:!1,key:"",data:null,path:""})},oe=async b=>{const a=b.target.files[0];if(a){m.path=a.path;const C=await Ae(a);m.data=C}},ne=async()=>{await ee(m.data,m.key),await w(),U()},se=async b=>{switch(b){case"all":g.value.type=null;break;case"store":g.value.type=he.STORE;break}await w()};return Te(async()=>{await w()}),(b,a)=>{const C=ve,pe=Ue("RouterLink"),le=xe,R=ke,K=H,ie=Y,re=O,me=j;return L(),Re(Ee,null,[t(le,{value:e(c),"onUpdate:value":[a[1]||(a[1]=s=>z(c)?c.value=s:null),se],style:Ke({"--number-bg-color":e(u)?"#262626":"#F0F0F0"})},{suffix:o(()=>[p("div",Xe,[t(e(A),{type:"primary",ghost:"",onClick:a[0]||(a[0]=s=>e(m).show=!0)},{default:o(()=>[p("div",Ge,[t(M,{type:"fileImport",size:"large",color:"#5671FF"}),_(" "+l(e(n)("Page.AutomationApps.Button.ImportApp")),1)])]),_:1}),t(e(A),{type:"primary",onClick:te},{default:o(()=>[p("div",He,[t(M,{type:"add",size:"large",color:"white"}),t(pe,{style:{color:"white"},to:"#"},{default:o(()=>[_(l(e(n)("Page.AutomationApps.Button.CreateApp")),1)]),_:1})])]),_:1})])]),default:o(()=>[t(C,{name:"all"},{default:o(()=>[p("div",Ve,[p("div",Oe,l(e(v).total),1),p("span",null,l(e(n)("Page.AutomationApps.Label.MyApps")),1)])]),_:1}),t(C,{name:"store"},{default:o(()=>[p("div",je,[p("div",qe,l(e(v).supcription),1),p("span",null,l(e(n)("Page.AutomationApps.Label.Subscription")),1)])]),_:1})]),_:1},8,["value","style"]),p("div",Ye,[p("div",Je,[t(Ce,{value:e(g).name,"onUpdate:value":a[2]||(a[2]=s=>e(g).name=s),class:"!w-auto",placeholder:e(n)("Common.Label.Search"),clearable:"","on-input":e(S)},null,8,["value","placeholder","on-input"])]),e(r).length>0?(L(),G(e(N),{key:0,class:"mt-2"},{default:o(()=>[t(e(A),{ghost:"",type:"error",onClick:a[3]||(a[3]=s=>e(d).deleteMultiApps=!0)},{icon:o(()=>[t(M,{type:"trash"})]),default:o(()=>[_(" "+l(e(n)("Common.Button.Delete")),1)]),_:1})]),_:1})):Fe("",!0),t(e(Me),{"checked-row-keys":e(r),"onUpdate:checkedRowKeys":a[4]||(a[4]=s=>z(r)?r.value=s:null),class:"mt-2",loading:e(x),data:e(P),columns:e(k),pagination:e(B),"row-key":s=>s.id,"row-props":e($),"on-page-update":e(Q),"on-page-size-update":e(W),onUpdateSorter:e(Z)},null,8,["checked-row-keys","loading","data","columns","pagination","row-key","row-props","on-page-update","on-page-size-update","onUpdateSorter"])]),p("input",{ref_key:"file",ref:T,type:"file",style:{display:"none"},accept:".genlogin",onChange:oe},null,544),t(I,{type:"delete",icon:"trash",header:e(n)("Page.AutomationApps.Label.DeleteApp"),"is-show":e(d).deleteApp,"cancel-label":e(n)("Common.Button.Keep"),"submit-label":e(n)("Common.Button.Delete"),"action-submit":e(D),onClose:a[5]||(a[5]=s=>e(d).deleteApp=!1)},{body:o(()=>[t(R,null,{default:o(()=>{var s,F;return[_(l(e(n)("Page.AutomationApps.Label.ConfirmDelete"))+" "+l((F=(s=e(h))==null?void 0:s.script)==null?void 0:F.name)+"?",1)]}),_:1})]),_:1},8,["header","is-show","cancel-label","submit-label","action-submit"]),t(I,{type:"delete",icon:"trash",header:e(n)("Page.AutomationApps.Label.DeleteApp"),"is-show":e(d).deleteMultiApps,"cancel-label":e(n)("Common.Button.Keep"),"submit-label":e(n)("Common.Button.Delete"),"action-submit":e(f),onClose:a[6]||(a[6]=s=>e(d).deleteMultiApps=!1)},{body:o(()=>[t(R,null,{default:o(()=>[_(l(e(n)("Common.Label.ConfirmCheck")),1)]),_:1})]),_:1},8,["header","is-show","cancel-label","submit-label","action-submit"]),t(Be,{"is-show":e(i).showRenameModal,header:"Rename",icon:"save","submit-label":"Save","action-submit":ae,onClose:a[8]||(a[8]=s=>e(i).showRenameModal=!1)},{body:o(()=>[t(K,{value:e(i).newName,"onUpdate:value":a[7]||(a[7]=s=>e(i).newName=s),placeholder:"Enter new name"},null,8,["value"])]),_:1},8,["is-show"]),t(me,{show:e(m).show,"onUpdate:show":a[11]||(a[11]=s=>e(m).show=s),onClose:U},{default:o(()=>[t(re,{title:"Import",style:{width:"600px"}},{default:o(()=>[t(e(N),{vertical:""},{default:o(()=>[p("div",Qe,[t(e(A),{onClick:a[9]||(a[9]=s=>e(T).click())},{default:o(()=>[_(l(e(n)("Common.Button.SelectFile")),1)]),_:1}),p("span",null,l(e(m).path),1)]),t(ie,{label:e(n)("Page.AutomationApps.Label.KeyOptional"),"show-feedback":!1},{default:o(()=>[t(K,{value:e(m).key,"onUpdate:value":a[10]||(a[10]=s=>e(m).key=s),placeholder:e(n)("Page.AutomationApps.Label.KeyPlaceholder"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"]),t(e(A),{type:"primary",onClick:ne},{default:o(()=>[_(l(e(n)("Common.Button.Submit")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["show"]),t(ze)],64)}}});const kt=Ie(We,[["__scopeId","data-v-56938770"]]);export{kt as default};
