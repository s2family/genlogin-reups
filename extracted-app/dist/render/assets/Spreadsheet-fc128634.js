import{bv as Y,b1 as Q,cc as R,ah as w,gk as Z,aL as ee,am as te,a7 as ae}from"./main-8b08e1d6.js";import{d as oe,i as le,a0 as ne,a as se,c as pe,b as x,m as re,S as d,X as f,Y as l,D as t,u as a,V as _,U as V,F as k,E as c,a2 as S,ag as ie,af as de,$ as C,q as ue}from"./_plugin-vue_export-helper-b059e461.js";import{_ as h}from"./ModalNode-47dd364b.js";import{b as me,a as fe}from"./useScriptEditor-4173e447.js";import{_ as he}from"./Radio-c980589e.js";import{_ as _e}from"./RadioGroup-69a7fbba.js";import{_ as ce}from"./FormItem-52ed65a1.js";import{_ as Se}from"./a-72358bba.js";import{_ as ge}from"./Checkbox-ce86da58.js";import{_ as be}from"./Select-f7c79767.js";import{_ as ve}from"./DynamicInput-debc4a5e.js";import{_ as ye}from"./Scrollbar-e90e60b7.js";import"./lodash-6114c6d4.js";import"./axios-1e30d922.js";import"./xlsx-f5126985.js";import"./ScriptEditor-c5673dff.js";import"./InputSearch.vue_vue_type_script_setup_true_lang-d786940a.js";import"./Input-96fa4693.js";import"./Suffix-fc59bb7a.js";import"./useMyApps-6a511b1e.js";import"./Divider-65f3d898.js";import"./Modal-0f4a5102.js";import"./_baseUniq-35fed69a.js";import"./toInteger-0dcb6e10.js";import"./SelectProfiles.vue_vue_type_script_setup_true_lang-3d20c4d9.js";import"./FormMakingResult-fec35bca.js";import"./useSavedTasks-dbe97dc3.js";import"./useRunScript-b4e924db.js";import"./useConsole-dd6c2120.js";import"./Upload-46a3755a.js";import"./Progress-0b0a0198.js";import"./_createCompounder-4af3bdce.js";import"./Alert-2eccd136.js";import"./InputNumber-c85d5887.js";import"./Remove-be3cc84a.js";import"./Grid-308f499b.js";import"./DatePicker-91499e1f.js";import"./Pagination-ce77c3f3.js";import"./ModalConfirm-92ee844f.js";import"./useSelectProfiles-b9438807.js";import"./firefox-icon-2ab5a045.js";import"./CollapseItem-114ac5a0.js";import"./Form-e484375f.js";import"./FormItemGridItem-951b0746.js";import"./vuedraggable.umd-e6c5d70a.js";import"./DataTable-e5054828.js";import"./InputSearch-1469c448.js";import"./InputGroup-20db4544.js";const we={class:"flex flex-auto gap-x-2"},Ve={class:"flex flex-auto gap-x-2"},ke={class:"flex gap-2"},Ce={class:"flex flex-auto gap-x-2"},Fe=_("div",null," = ",-1),wt=oe({__name:"Spreadsheet",setup(Ue){const{scriptId:O}=me(),{editor:D,variables:A,modalNode:e}=le(O),B=ne(()=>Y(()=>import("./CodeMirror-6b863184.js"),["./CodeMirror-6b863184.js","./CodeMirror.vue_vue_type_style_index_0_lang-e5da641a.js","./ScriptEditor-c5673dff.js","./main-8b08e1d6.js","./_plugin-vue_export-helper-b059e461.js","./lodash-6114c6d4.js","./axios-1e30d922.js","./xlsx-f5126985.js","./index-9b0004e2.css","./InputSearch.vue_vue_type_script_setup_true_lang-d786940a.js","./Input-96fa4693.js","./Suffix-fc59bb7a.js","./useMyApps-6a511b1e.js","./useScriptEditor-4173e447.js","./a-72358bba.js","./Divider-65f3d898.js","./Modal-0f4a5102.js","./DynamicInput-debc4a5e.js","./Remove-be3cc84a.js","./DataTable-e5054828.js","./Checkbox-ce86da58.js","./RadioGroup-69a7fbba.js","./Radio-c980589e.js","./Select-f7c79767.js","./Pagination-ce77c3f3.js","./_baseUniq-35fed69a.js","./toInteger-0dcb6e10.js","./SelectProfiles.vue_vue_type_script_setup_true_lang-3d20c4d9.js","./FormMakingResult-fec35bca.js","./useSavedTasks-dbe97dc3.js","./useRunScript-b4e924db.js","./useConsole-dd6c2120.js","./Upload-46a3755a.js","./Progress-0b0a0198.js","./_createCompounder-4af3bdce.js","./Alert-2eccd136.js","./InputNumber-c85d5887.js","./Grid-308f499b.js","./FormMakingResult-47970b1e.css","./DatePicker-91499e1f.js","./ModalConfirm-92ee844f.js","./ModalConfirm-bf8879fe.css","./useSelectProfiles-b9438807.js","./firefox-icon-2ab5a045.js","./SelectProfiles-7d1e4bd4.css","./CollapseItem-114ac5a0.js","./Scrollbar-e90e60b7.js","./FormItem-52ed65a1.js","./Form-e484375f.js","./FormItemGridItem-951b0746.js","./vuedraggable.umd-e6c5d70a.js","./InputSearch-1469c448.js","./InputSearch-0af12d4f.css","./ScriptEditor-bcef1e8d.css","./CodeMirror-d80a0954.css"],import.meta.url)),{newVariable:F,createNewVariable:M,onSearchVariable:N,variableOptions:$,prepareAutomation:E}=fe(D.value,A.value),u=se({rawData:"",error:""}),v=pe(()=>JSON.stringify(u.rawData,void 0,2)),U=x(null),I=x(null),K=async()=>{Object.assign(u,{previewData:"",error:""});const r=await E();r.testId=e.node.id;const o=await Z(r),{data:{success:s,data:i,error:m}}=o;s?u.rawData=i:(u.rawData="",u.error=m==null?void 0:m.message)},H=r=>{const s=r.target.files[0];s&&(e.options.spreadSheetFile=s.path)},P=r=>{const s=r.target.files[0];s&&(e.options.spreadSheetCredentialFile=s.path)},L=r=>{const o=M();e.options.spreadSheetOutputBVariables[r].outputVariable=o},W=()=>({outputVariable:"",path:""}),j=Q(r=>{r||(e.options.spreadSheetRefKey=R(5))},500),J=()=>{window.open("https://login-gen.gitbook.io/genlogin-help-center-3.0/automation-genlogin/huong-dan-su-dung-google-sheet")};return re(()=>{var r,o,s,i;e.options.spreadSheetMode=e.options.spreadSheetMode||"local",e.options.spreadSheetAction=e.options.spreadSheetAction||"read",e.options.spreadSheetFile=e.options.spreadSheetFile||"",e.options.spreadSheetRange=e.options.spreadSheetRange||"",e.options.spreadSheetFirstRowHeaders=e.options.spreadSheetFirstRowHeaders!==void 0?e.options.spreadSheetFirstRowHeaders:!0,e.options.spreadSheetRefKey=e.options.spreadSheetRefKey||R(5),e.options.spreadSheetStorage=e.options.spreadSheetStorage||"variables",e.options.spreadSheetWriteMethod=e.options.spreadSheetWriteMethod||"array",e.options.spreadSheetOutputBVariables=((r=e.options)==null?void 0:r.spreadSheetOutputBVariables)||[{outputVariable:"",path:""}],e.options.spreadSheetId=((o=e.options)==null?void 0:o.spreadSheetId)||"",e.options.spreadSheetCredentialFile=((s=e.options)==null?void 0:s.spreadSheetCredentialFile)||"",e.options.spreadSheetCredentialInput=((i=e.options)==null?void 0:i.spreadSheetCredentialInput)||"file"}),(r,o)=>{const s=he,i=ee,m=_e,p=ce,g=te,T=Se,q=ge,G=be,z=ve,y=ye,X=ae;return d(),f(y,{trigger:"none",style:{height:"50vh","padding-right":"24px"}},{default:l(()=>[t(i,{vertical:""},{default:l(()=>[t(p,{"show-feedback":!1,label:"Sheet type"},{default:l(()=>[t(m,{value:a(e).options.spreadSheetMode,"onUpdate:value":o[0]||(o[0]=n=>a(e).options.spreadSheetMode=n)},{default:l(()=>[t(i,null,{default:l(()=>[t(s,{label:"Local",value:"local"}),t(s,{label:"Cloud (Google sheet)",value:"cloud"})]),_:1})]),_:1},8,["value"])]),_:1}),t(p,{"show-feedback":!1,label:"Action"},{default:l(()=>[t(m,{value:a(e).options.spreadSheetAction,"onUpdate:value":o[1]||(o[1]=n=>a(e).options.spreadSheetAction=n)},{default:l(()=>[t(i,null,{default:l(()=>[t(s,{label:"Read",value:"read"}),t(s,{label:"Write",value:"write"}),t(s,{label:"Clear",value:"clear"})]),_:1})]),_:1},8,["value"])]),_:1}),a(e).options.spreadSheetMode==="local"?(d(),f(p,{key:0,"show-feedback":!1,label:"File path"},{default:l(()=>[_("div",we,[t(h,{modelValue:a(e).options.spreadSheetFile,"onUpdate:modelValue":o[2]||(o[2]=n=>a(e).options.spreadSheetFile=n),placeholder:""},null,8,["modelValue"]),t(g,{type:"primary",dashed:"",onClick:o[3]||(o[3]=n=>a(U).click())},{icon:l(()=>[t(w,{type:"selectFile"})]),_:1})])]),_:1})):(d(),V(k,{key:1},[t(T,{onClick:J},{default:l(()=>[c(" How to setup Google Sheet ")]),_:1}),t(p,{"show-feedback":!1,label:"Sheet ID"},{default:l(()=>[_("div",Ve,[t(h,{modelValue:a(e).options.spreadSheetId,"onUpdate:modelValue":o[4]||(o[4]=n=>a(e).options.spreadSheetId=n),placeholder:""},null,8,["modelValue"])])]),_:1}),_("div",ke,[t(p,{"show-feedback":!1,label:"Credential input type"},{default:l(()=>[t(m,{value:a(e).options.spreadSheetCredentialInput,"onUpdate:value":o[5]||(o[5]=n=>a(e).options.spreadSheetCredentialInput=n)},{default:l(()=>[t(i,null,{default:l(()=>[t(s,{label:"File",value:"file"}),t(s,{label:"String",value:"string"})]),_:1})]),_:1},8,["value"])]),_:1}),t(p,{class:"w-3/4","show-feedback":!1,label:a(e).options.spreadSheetCredentialInput==="file"?"Credential file":"Credential string"},{default:l(()=>[_("div",Ce,[t(h,{modelValue:a(e).options.spreadSheetCredentialFile,"onUpdate:modelValue":o[6]||(o[6]=n=>a(e).options.spreadSheetCredentialFile=n),placeholder:a(e).options.spreadSheetCredentialInput==="file"?"JSON file":"JSON string"},null,8,["modelValue","placeholder"]),a(e).options.spreadSheetCredentialInput==="file"?(d(),f(g,{key:0,type:"primary",dashed:"",onClick:o[7]||(o[7]=n=>a(I).click())},{icon:l(()=>[t(w,{type:"selectFile"})]),_:1})):S("",!0)])]),_:1},8,["label"])])],64)),t(i,null,{default:l(()=>[t(p,{"show-feedback":a(e).options.spreadSheetAction==="write",label:"Range",feedback:a(e).options.spreadSheetAction==="write"?"Leave empty will append data":""},{default:l(()=>[t(h,{modelValue:a(e).options.spreadSheetRange,"onUpdate:modelValue":o[8]||(o[8]=n=>a(e).options.spreadSheetRange=n),placeholder:"E.g: A1"},null,8,["modelValue"])]),_:1},8,["show-feedback","feedback"]),t(p,{"show-feedback":!1,label:"Sheet name (Optional)"},{default:l(()=>[t(h,{modelValue:a(e).options.spreadSheetName,"onUpdate:modelValue":o[9]||(o[9]=n=>a(e).options.spreadSheetName=n),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1}),t(q,{checked:a(e).options.spreadSheetFirstRowHeaders,"onUpdate:checked":o[10]||(o[10]=n=>a(e).options.spreadSheetFirstRowHeaders=n)},{default:l(()=>[c(" First row as keys ")]),_:1},8,["checked"]),a(e).options.spreadSheetAction==="read"?(d(),V(k,{key:2},[t(p,{"show-feedback":!1,label:"Storage"},{default:l(()=>[t(m,{value:a(e).options.spreadSheetStorage,"onUpdate:value":o[11]||(o[11]=n=>a(e).options.spreadSheetStorage=n)},{default:l(()=>[t(i,null,{default:l(()=>[t(s,{label:"Variables",value:"variables"}),t(s,{label:"Loop data",value:"loopData"})]),_:1})]),_:1},8,["value"])]),_:1}),a(e).options.spreadSheetStorage==="loopData"?(d(),f(p,{key:0,"show-feedback":!1,label:"Ref key"},{default:l(()=>[t(h,{modelValue:a(e).options.spreadSheetRefKey,"onUpdate:modelValue":[o[12]||(o[12]=n=>a(e).options.spreadSheetRefKey=n),a(j)],placeholder:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1})):(d(),f(y,{key:1,style:{"max-height":"25vh"},class:"mb-5"},{default:l(()=>[t(p,{"show-feedback":!1,label:"Map spreadsheet data"},{default:l(()=>[t(z,{value:a(e).options.spreadSheetOutputBVariables,"onUpdate:value":o[14]||(o[14]=n=>a(e).options.spreadSheetOutputBVariables=n),"on-create":W},{default:l(({index:n})=>[t(i,{align:"center"},{default:l(()=>[t(p,{"ignore-path-change":"","show-label":!1,"show-feedback":!1},{default:l(()=>[t(h,{modelValue:a(e).options.spreadSheetOutputBVariables[n].path,"onUpdate:modelValue":b=>a(e).options.spreadSheetOutputBVariables[n].path=b,placeholder:"Path",onKeydown:o[13]||(o[13]=ie(de(()=>{},["prevent"]),["enter"]))},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),Fe,t(p,{"ignore-path-change":"","show-label":!1,"show-feedback":!1},{default:l(()=>[t(G,{value:a(e).options.spreadSheetOutputBVariables[n].outputVariable,"onUpdate:value":b=>a(e).options.spreadSheetOutputBVariables[n].outputVariable=b,placeholder:"Variable",options:a($),clearable:"",filterable:"","on-search":a(N)},{empty:l(()=>[a(F).length?(d(),f(g,{key:0,dashed:"",onClick:b=>L(n)},{icon:l(()=>[t(w,{type:"add"})]),default:l(()=>[c(" Create "+C(a(F)),1)]),_:2},1032,["onClick"])):S("",!0)]),_:2},1032,["value","onUpdate:value","options","on-search"])]),_:2},1024)]),_:2},1024)]),_:1},8,["value"])]),_:1})]),_:1}))],64)):a(e).options.spreadSheetAction==="write"?(d(),V(k,{key:3},[t(p,{"show-feedback":!1,label:"Input variable"},{default:l(()=>[t(h,{modelValue:a(e).options.spreadSheetInput,"onUpdate:modelValue":o[15]||(o[15]=n=>a(e).options.spreadSheetInput=n),placeholder:""},null,8,["modelValue"])]),_:1}),t(p,{"show-feedback":!1,label:"Target"},{default:l(()=>[t(m,{value:a(e).options.spreadSheetWriteMethod,"onUpdate:value":o[16]||(o[16]=n=>a(e).options.spreadSheetWriteMethod=n)},{default:l(()=>[t(i,null,{default:l(()=>[t(s,{label:"Array",value:"array"}),t(s,{label:"JSON",value:"json"})]),_:1})]),_:1},8,["value"])]),_:1})],64)):S("",!0),t(i,null,{default:l(()=>[t(g,{size:"small",type:"success",onClick:K},{default:l(()=>[c(" Preview ")]),_:1}),_("small",null,C(a(u).rawData.length)+" items",1)]),_:1}),a(u).error.length?(d(),f(X,{key:4,type:"error"},{default:l(()=>[c(C(a(u).error),1)]),_:1})):S("",!0),t(y,{trigger:"none",style:{"max-height":"auto","padding-right":"24px"}},{default:l(()=>[a(u).rawData.length?(d(),f(a(B),{key:0,"model-value":a(v),"onUpdate:modelValue":o[17]||(o[17]=n=>ue(v)?v.value=n:null),style:{height:"350px"},class:"overflow-auto",lang:"json",readonly:""},null,8,["model-value"])):S("",!0)]),_:1}),_("input",{ref_key:"file",ref:U,type:"file",style:{display:"none"},onChange:H},null,544),_("input",{ref_key:"fileCredential",ref:I,type:"file",style:{display:"none"},onChange:P},null,544)]),_:1})]),_:1})}}});export{wt as default};
