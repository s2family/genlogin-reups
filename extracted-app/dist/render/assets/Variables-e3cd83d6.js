import{d as ue,c as V,b as C,m as pe,S as l,X as m,Y as o,U as u,E as i,F as w,ad as S,u as t,$ as f,a2 as b,D as c,q as E,ag as M,af as W,V as _,ae as q,ab as ie,ac as _e,a1 as de}from"./_plugin-vue_export-helper-b059e461.js";import{a as me,f as H}from"./useScriptEditor-4173e447.js";import{G as fe,aq as ve,ah as ye,ca as ge,aY as be,a7 as he,aL as xe,aA as ke,am as we,aQ as Se}from"./main-8b08e1d6.js";import{u as Ue,b as Ve}from"./FormMakingResult-fec35bca.js";import{_ as Ce}from"./Input-96fa4693.js";import{_ as Te}from"./Checkbox-ce86da58.js";import{_ as Ne}from"./FormItem-52ed65a1.js";import{_ as $e}from"./Scrollbar-e90e60b7.js";import{_ as Ae}from"./DynamicInput-debc4a5e.js";import{_ as Oe}from"./Select-f7c79767.js";import"./lodash-6114c6d4.js";import"./axios-1e30d922.js";import"./xlsx-f5126985.js";import"./useMyApps-6a511b1e.js";import"./a-72358bba.js";import"./useSavedTasks-dbe97dc3.js";import"./useRunScript-b4e924db.js";import"./useConsole-dd6c2120.js";import"./Radio-c980589e.js";import"./RadioGroup-69a7fbba.js";import"./Upload-46a3755a.js";import"./Progress-0b0a0198.js";import"./_createCompounder-4af3bdce.js";import"./Divider-65f3d898.js";import"./Alert-2eccd136.js";import"./InputNumber-c85d5887.js";import"./Remove-be3cc84a.js";import"./Grid-308f499b.js";import"./Suffix-fc59bb7a.js";import"./DataTable-e5054828.js";import"./Pagination-ce77c3f3.js";const K=d=>(ie("data-v-8dcdbab4"),d=d(),_e(),d),De={key:0,class:"flex flex-row gap-2 mb-5"},Fe={class:"flex flex-col gap-y-2"},Ye=K(()=>_("div",null," = ",-1)),Be={class:"flex flex-col"},Ie={class:"flex flex-auto gap-x-2"},Le={key:1},je={class:"mt-24px"},Ee=K(()=>_("div",{class:"font-semibold"}," Table Variables ",-1)),Me={class:"flex flex-col items-center gap-8px mt-16px"},We={key:0,class:"flex items-center gap-8px mt-16px flex-wrap"},qe={key:0,class:"flex items-center gap-8px w-180px overflow-auto"},He={key:1,class:"flex items-center gap-8px w-180px overflow-auto"},Ke={key:2},Re=ue({__name:"Variables",props:{publicOnly:{type:Boolean,default:!1}},setup(d){const R=d,{route:z}=fe(),G=V(()=>z.name),{formatDateTime:Q}=ve(),{tableOptions:X,selectedTable:h,onSelectTable:J,getTables:P}=Ue(),{variables:U,customFields:x,selectedAccount:v,accountSelected:y}=me(),{accounts:T,getAppAccounts:N}=Ve(),Z=V(()=>T.value.map((n,s)=>{const p=x.value.map(g=>n.data[g.key]||"-").join("|");return{label:`${s+1}. ${p}`,value:n.id}})),$=C(null),A=C(null),r=V({get(){return R.publicOnly?U.value.filter(n=>!n.secret):U.value},set(n){U.value=n}}),O=C(0),ee=n=>{var s;O.value=n,(s=A.value)==null||s.click()},te=n=>{const p=n.target.files[0];p&&(r.value[O.value].value=p.path)},ae=()=>{const n=document.querySelector("#variablesWrapper").scrollHeight;return $.value.scrollTo(n),{id:ge(5),name:"",label:"",value:"",secret:!1}},le=async n=>{J(n),x.value=h.value.custom_fields_array,v.value=null,await N(),y.value={}},oe=async n=>{v.value=n;const s=T.value.find(p=>p.id===n);y.value=s?s.data:{}};return pe(async()=>{await N(),await P(),h.value&&(x.value=h.value.custom_fields_array||[])}),(n,s)=>{const p=be,g=Ce,ne=he,D=xe,se=Te,F=ke,Y=Ne,B=$e,ce=we,re=Ae,I=Oe,k=Se;return l(),m(B,{id:"variablesWrapper",ref_key:"variablesWrapper",ref:$,trigger:"none",style:{"max-height":"600px"}},{default:o(()=>{var L;return[d.publicOnly?b("",!0):(l(),u("div",De,[i(" Constant variables "),(l(!0),u(w,null,S(Object.keys(t(H)),(e,a)=>(l(),m(p,{key:a},{default:o(()=>[i(f(t(H)[e].name),1)]),_:2},1024))),128))])),c(re,{value:t(r),"onUpdate:value":s[2]||(s[2]=e=>E(r)?r.value=e:null),"on-create":ae},{default:o(({index:e})=>[c(D,{align:"center"},{default:o(()=>[c(Y,{"ignore-path-change":"","show-label":!1,"show-feedback":!1},{default:o(()=>[d.publicOnly?(l(),m(g,{key:0,value:t(r)[e].label||t(r)[e].name,readonly:"",disabled:""},null,8,["value"])):(l(),m(F,{key:1,placement:"top",trigger:"hover"},{trigger:o(()=>[c(g,{value:t(r)[e].name,"onUpdate:value":a=>t(r)[e].name=a,placeholder:"Name",onKeydown:s[0]||(s[0]=M(W(()=>{},["prevent"]),["enter"]))},null,8,["value","onUpdate:value"])]),default:o(()=>[_("div",Fe,[c(D,null,{default:o(()=>[c(ne,{class:"flex-grow"},{default:o(()=>[i(" Label ")]),_:1}),c(g,{value:t(r)[e].label,"onUpdate:value":a=>t(r)[e].label=a,class:"flex-2",placeholder:"Label",onKeydown:s[1]||(s[1]=M(W(()=>{},["prevent"]),["enter"]))},null,8,["value","onUpdate:value"])]),_:2},1024),c(se,{checked:t(r)[e].secret,"onUpdate:checked":a=>t(r)[e].secret=a},{default:o(()=>[i(" Secret ")]),_:2},1032,["checked","onUpdate:checked"])])]),_:2},1024))]),_:2},1024),Ye,c(Y,{"ignore-path-change":"","show-label":!1,"show-feedback":!1},{default:o(()=>[c(F,{delay:500,placement:"top",trigger:"hover"},{trigger:o(()=>[c(g,{value:t(r)[e].value,"onUpdate:value":a=>t(r)[e].value=a,placeholder:"Name",style:{width:"200px"},type:"textarea",autosize:{minRows:1,maxRows:2}},null,8,["value","onUpdate:value"])]),default:o(()=>[c(B,{style:{maxHeight:"200px"},class:"w-400px"},{default:o(()=>[_("p",Be,f(t(r)[e].value),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),_("div",Ie,[c(ce,{type:"primary",dashed:"",onClick:a=>ee(e)},{icon:o(()=>[c(ye,{type:"selectFile"})]),_:2},1032,["onClick"])])]),_:2},1024)]),_:1},8,["value"]),_("input",{ref_key:"file",ref:A,type:"file",style:{display:"none"},onChange:te},null,544),t(G)==="main.scriptEditor"?(l(),u("div",Le,[_("div",je,[Ee,_("div",Me,[c(I,{"default-value":(L=t(h))==null?void 0:L.id,options:t(X),placeholder:"Select table",onUpdateValue:le},null,8,["default-value","options"]),c(I,{value:t(v),"onUpdate:value":s[3]||(s[3]=e=>E(v)?v.value=e:null),options:t(Z),placeholder:"Select account",onUpdateValue:oe},null,8,["value","options"])]),t(v)?(l(),u("div",We,[(l(!0),u(w,null,S(t(x),e=>(l(),u("div",{key:e.key,class:"w-320px flex items-center gap-8px mt-16px"},[c(k,{class:"flex items-center justify-between",style:{width:"120px"}},{default:o(()=>[i(f(e.title)+": ",1)]),_:2},1024),e.type==="multiSelect"?(l(),u("div",qe,[(l(!0),u(w,null,S(e.options,a=>{var j;return l(),u("div",{key:a},[(j=t(y)[e.key])!=null&&j.includes(a.value)?(l(),m(k,{key:0,class:q([a.color,"tag-color rounded-4px text-center flex items-center justify-center"]),style:{"min-width":"30px","max-width":"80px"}},{default:o(()=>[i(f(a.value),1)]),_:2},1032,["class"])):b("",!0)])}),128))])):["select","status"].includes(e.type)?(l(),u("div",He,[(l(!0),u(w,null,S(e.options,a=>(l(),u("div",{key:a},[t(y)[e.key]===a.value?(l(),m(k,{key:0,class:q([a.color,"tag-color rounded-4px text-center"]),style:{"min-width":"30px","max-width":"80px"}},{default:o(()=>[i(f(a.value),1)]),_:2},1032,["class"])):b("",!0)]))),128))])):e.type==="date"?(l(),u("div",Ke,f(t(Q)(t(y)[e.key],"DD/MM/YYYY hh:mm:ss")),1)):(l(),m(k,{key:3},{default:o(()=>[i(f(t(y)[e.key]),1)]),_:2},1024))]))),128))])):b("",!0)])])):b("",!0)]}),_:1},512)}}});const St=de(Re,[["__scopeId","data-v-8dcdbab4"]]);export{St as default};
