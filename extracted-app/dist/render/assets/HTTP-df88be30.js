import{d as W,i as Z,b as x,r as ee,c as oe,m as ae,o as te,S as i,X as d,Y as t,D as a,u as o,ag as U,af as N,U as le,E as g,a2 as V,$ as B,V as O}from"./_plugin-vue_export-helper-b059e461.js";import{b as ne,a as se,j as f,p as y}from"./useScriptEditor-4173e447.js";import{ah as pe,gg as ue,a3 as re,aL as ie,a7 as de,am as me,a0 as _e,a1 as fe}from"./main-8b08e1d6.js";import{_ as b}from"./ModalNode-47dd364b.js";import{a as ce}from"./useConsole-dd6c2120.js";import{_ as be}from"./Radio-c980589e.js";import{_ as ve}from"./RadioGroup-69a7fbba.js";import{_ as he}from"./FormItem-52ed65a1.js";import{_ as ye}from"./Input-96fa4693.js";import{_ as ge}from"./DynamicInput-debc4a5e.js";import{_ as Ve,a as we}from"./CollapseItem-114ac5a0.js";import{_ as Te}from"./Select-f7c79767.js";import{_ as ke}from"./Scrollbar-e90e60b7.js";import{_ as Ue}from"./Divider-65f3d898.js";import"./lodash-6114c6d4.js";import"./axios-1e30d922.js";import"./xlsx-f5126985.js";import"./ScriptEditor-c5673dff.js";import"./InputSearch.vue_vue_type_script_setup_true_lang-d786940a.js";import"./useMyApps-6a511b1e.js";import"./a-72358bba.js";import"./Modal-0f4a5102.js";import"./_baseUniq-35fed69a.js";import"./toInteger-0dcb6e10.js";import"./SelectProfiles.vue_vue_type_script_setup_true_lang-3d20c4d9.js";import"./FormMakingResult-fec35bca.js";import"./useSavedTasks-dbe97dc3.js";import"./useRunScript-b4e924db.js";import"./Checkbox-ce86da58.js";import"./Upload-46a3755a.js";import"./Progress-0b0a0198.js";import"./_createCompounder-4af3bdce.js";import"./Alert-2eccd136.js";import"./InputNumber-c85d5887.js";import"./Remove-be3cc84a.js";import"./Grid-308f499b.js";import"./DatePicker-91499e1f.js";import"./Pagination-ce77c3f3.js";import"./ModalConfirm-92ee844f.js";import"./useSelectProfiles-b9438807.js";import"./firefox-icon-2ab5a045.js";import"./Form-e484375f.js";import"./FormItemGridItem-951b0746.js";import"./vuedraggable.umd-e6c5d70a.js";import"./DataTable-e5054828.js";import"./Suffix-fc59bb7a.js";import"./InputSearch-1469c448.js";import"./InputGroup-20db4544.js";const Ne=O("div",null," = ",-1),Oe=O("div",null," = ",-1),Se=O("div",null," = ",-1),Re={key:0},De=O("div",null," = ",-1),Ee=O("div",null," = ",-1),So=W({__name:"HTTP",setup(Be){const{scriptId:$}=ne(),{editor:F,variables:M,modalNode:e}=Z($),{newVariable:C,createNewVariable:K,onSearchVariable:A,variableOptions:I,prepareAutomation:L}=se(F.value,M.value),j=[{label:"JSON",value:f.JSON},{label:"Text",value:f.TEXT},{label:"Form URLEncoded",value:f.FORM_URL_ENCODED},{label:"Form Data",value:f.FORM_DATA}],S=()=>({name:"",value:""}),G=()=>({outputVariable:"",path:""}),X=r=>{const n=K();e.options.outputBodyVariables[r].outputVariable=n},D=x(!1),u=ee({status:0,headers:"",body:"",error:""}),q=async()=>{try{D.value=!0;let r=await L();r.testId=e.node.id;const n=await ue(re(r)),m=JSON.parse(n.data);u.status=parseInt(m.status),u.headers=JSON.stringify(m.headers,void 0,2),u.body=JSON.stringify(m.data,void 0,2)}catch(r){u.error=(r==null?void 0:r.error)||r}finally{D.value=!1}},Y=oe(()=>{if(e.options.method!==y.GET&&e.options.body)try{return JSON.parse(e.options.body),!0}catch{return!1}return!0});return ae(()=>{var r,n,m,_,w,s,v,c,h,T,k;e.options.url=((r=e.options)==null?void 0:r.url)||"",e.options.method=((n=e.options)==null?void 0:n.method)||y.GET,e.options.contentType=((m=e.options)==null?void 0:m.contentType)||f.JSON,e.options.body=((_=e.options)==null?void 0:_.body)||"",e.options.responseType=((w=e.options)==null?void 0:w.responseType)||"JSON",e.options.outputRawVariable=((s=e.options)==null?void 0:s.outputRawVariable)||"",e.options.headers=((v=e.options)==null?void 0:v.headers)||[{name:"",value:""}],e.options.cookies=((c=e.options)==null?void 0:c.cookies)||[{name:"",value:""}],e.options.params=((h=e.options)==null?void 0:h.params)||[{name:"",value:""}],e.options.formData=((T=e.options)==null?void 0:T.formData)||[{name:"",value:""}],e.options.outputBodyVariables=((k=e.options)==null?void 0:k.outputBodyVariables)||[{outputVariable:"",path:""}]}),te(()=>{u.headers="",u.body="",u.error=""}),(r,n)=>{const m=be,_=ie,w=ve,s=he,v=ye,c=ge,h=Ve,T=we,k=Te,E=de,P=me,J=ce,R=ke,H=_e,z=fe,Q=Ue;return i(),d(R,{trigger:"none",style:{height:"50vh","padding-right":"24px"}},{default:t(()=>[a(_,{vertical:""},{default:t(()=>[a(s,{"show-feedback":!1,label:"Request method"},{default:t(()=>[a(w,{value:o(e).options.method,"onUpdate:value":n[0]||(n[0]=l=>o(e).options.method=l)},{default:t(()=>[a(_,null,{default:t(()=>[a(m,{label:"GET",value:o(y).GET},null,8,["value"]),a(m,{label:"POST",value:o(y).POST},null,8,["value"]),a(m,{label:"PUT",value:o(y).PUT},null,8,["value"])]),_:1})]),_:1},8,["value"])]),_:1}),a(s,{"show-feedback":!1,label:"URL"},{default:t(()=>[a(b,{modelValue:o(e).options.url,"onUpdate:modelValue":n[1]||(n[1]=l=>o(e).options.url=l),placeholder:"Enter url"},null,8,["modelValue"])]),_:1}),a(T,null,{default:t(()=>[a(h,{title:"Headers"},{default:t(()=>[a(s,{"show-feedback":!1,"show-label":!1},{default:t(()=>[a(c,{value:o(e).options.headers,"onUpdate:value":n[3]||(n[3]=l=>o(e).options.headers=l),"on-create":S},{default:t(({index:l})=>[a(_,{align:"center"},{default:t(()=>[a(s,{"ignore-path-change":"","show-label":!1,"show-feedback":!1},{default:t(()=>[a(v,{value:o(e).options.headers[l].name,"onUpdate:value":p=>o(e).options.headers[l].name=p,placeholder:"Name",onKeydown:n[2]||(n[2]=U(N(()=>{},["prevent"]),["enter"]))},null,8,["value","onUpdate:value"])]),_:2},1024),Ne,a(s,{"ignore-path-change":"","show-label":!1,"show-feedback":!1},{default:t(()=>[(i(),d(b,{key:l,modelValue:o(e).options.headers[l].value,"onUpdate:modelValue":p=>o(e).options.headers[l].value=p,placeholder:"Value"},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1024)]),_:2},1024)]),_:1},8,["value"])]),_:1})]),_:1}),a(h,{title:"Params"},{default:t(()=>[a(s,{"show-feedback":!1,"show-label":!1},{default:t(()=>[a(c,{value:o(e).options.params,"onUpdate:value":n[5]||(n[5]=l=>o(e).options.params=l),"on-create":S},{default:t(({index:l})=>[a(_,{align:"center"},{default:t(()=>[a(s,{"ignore-path-change":"","show-label":!1,"show-feedback":!1},{default:t(()=>[a(v,{value:o(e).options.params[l].name,"onUpdate:value":p=>o(e).options.params[l].name=p,placeholder:"Name",onKeydown:n[4]||(n[4]=U(N(()=>{},["prevent"]),["enter"]))},null,8,["value","onUpdate:value"])]),_:2},1024),Oe,a(s,{"ignore-path-change":"","show-label":!1,"show-feedback":!1},{default:t(()=>[(i(),d(b,{key:l,modelValue:o(e).options.params[l].value,"onUpdate:modelValue":p=>o(e).options.params[l].value=p,placeholder:"Value"},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1024)]),_:2},1024)]),_:1},8,["value"])]),_:1})]),_:1}),a(h,{title:"Cookies"},{default:t(()=>[a(s,{"show-feedback":!1,"show-label":!1},{default:t(()=>[a(c,{value:o(e).options.cookies,"onUpdate:value":n[7]||(n[7]=l=>o(e).options.cookies=l),"on-create":S},{default:t(({index:l})=>[a(_,{align:"center"},{default:t(()=>[a(s,{"ignore-path-change":"","show-label":!1,"show-feedback":!1},{default:t(()=>[a(v,{value:o(e).options.cookies[l].name,"onUpdate:value":p=>o(e).options.cookies[l].name=p,placeholder:"Name",onKeydown:n[6]||(n[6]=U(N(()=>{},["prevent"]),["enter"]))},null,8,["value","onUpdate:value"])]),_:2},1024),Se,a(s,{"ignore-path-change":"","show-label":!1,"show-feedback":!1},{default:t(()=>[(i(),d(b,{key:l,modelValue:o(e).options.cookies[l].value,"onUpdate:modelValue":p=>o(e).options.cookies[l].value=p,placeholder:"Value"},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1024)]),_:2},1024)]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),[o(y).POST,o(y).PUT].includes(o(e).options.method)?(i(),le("div",Re,[a(_,{vertical:""},{default:t(()=>[a(s,{"show-feedback":!1,label:"Content type"},{default:t(()=>[a(k,{value:o(e).options.contentType,"onUpdate:value":n[8]||(n[8]=l=>o(e).options.contentType=l),options:j},null,8,["value"])]),_:1}),[o(f).JSON,o(f).TEXT].includes(o(e).options.contentType)?(i(),d(s,{key:0,label:"Body"},{feedback:t(()=>[o(Y)?V("",!0):(i(),d(E,{key:0,type:"error"},{default:t(()=>[g(" Body JSON is not valid ")]),_:1}))]),default:t(()=>[a(b,{modelValue:o(e).options.body,"onUpdate:modelValue":n[9]||(n[9]=l=>o(e).options.body=l),autosize:{minRows:3,maxRows:5},type:"textarea"},null,8,["modelValue"])]),_:1})):[o(f).FORM_DATA,o(f).FORM_URL_ENCODED].includes(o(e).options.contentType)?(i(),d(T,{key:1},{default:t(()=>[a(h,{title:"Form data"},{default:t(()=>[a(s,{"show-feedback":!1,"show-label":!1},{default:t(()=>[a(c,{value:o(e).options.formData,"onUpdate:value":n[11]||(n[11]=l=>o(e).options.formData=l),"on-create":S},{default:t(({index:l})=>[a(_,{align:"center"},{default:t(()=>[a(s,{"ignore-path-change":"","show-label":!1,"show-feedback":!1},{default:t(()=>[a(v,{value:o(e).options.formData[l].name,"onUpdate:value":p=>o(e).options.formData[l].name=p,placeholder:"Name",onKeydown:n[10]||(n[10]=U(N(()=>{},["prevent"]),["enter"]))},null,8,["value","onUpdate:value"])]),_:2},1024),De,a(s,{"ignore-path-change":"","show-label":!1,"show-feedback":!1},{default:t(()=>[(i(),d(b,{key:l,modelValue:o(e).options.formData[l].value,"onUpdate:modelValue":p=>o(e).options.formData[l].value=p,placeholder:"Value"},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1024)]),_:2},1024)]),_:1},8,["value"])]),_:1})]),_:1})]),_:1})):V("",!0)]),_:1})])):V("",!0),a(s,{"show-feedback":!1,label:"Response type"},{default:t(()=>[a(w,{value:o(e).options.responseType,"onUpdate:value":n[12]||(n[12]=l=>o(e).options.responseType=l)},{default:t(()=>[a(_,null,{default:t(()=>[a(m,{label:"JSON",value:"JSON"}),a(m,{label:"Raw",value:"Raw"})]),_:1})]),_:1},8,["value"])]),_:1}),a(P,{type:"primary",loading:o(D),onClick:q},{default:t(()=>[g(" Test ")]),_:1},8,["loading"]),o(u).error?(i(),d(E,{key:1},{default:t(()=>[g(B(o(u).error),1)]),_:1})):V("",!0),o(u).status?(i(),d(E,{key:2,strong:"",class:"font-semibold",type:o(u).status>=200&&o(u).status<=299?"success":"error"},{default:t(()=>[g(" Status: "+B(o(u).status),1)]),_:1},8,["type"])):V("",!0),a(z,{type:"line",animated:"","default-value":"body"},{default:t(()=>[a(H,{name:"oasis",tab:"Headers"},{default:t(()=>[a(R,{style:{"max-height":"300px"}},{default:t(()=>[a(J,{code:o(u).headers,language:"json"},null,8,["code"])]),_:1})]),_:1}),a(H,{name:"body",tab:"Body"},{default:t(()=>[a(R,{style:{"max-height":"300px"}},{default:t(()=>[a(J,{code:o(u).body,language:"json"},null,8,["code"])]),_:1})]),_:1})]),_:1}),a(Q,{class:"!my-0"},{default:t(()=>[g(" Response ")]),_:1}),a(R,{style:{"max-height":"25vh"},class:"mb-5"},{default:t(()=>[o(e).options.responseType==="JSON"?(i(),d(s,{key:0,"show-feedback":!1,label:"Response body mapping"},{default:t(()=>[a(c,{value:o(e).options.outputBodyVariables,"onUpdate:value":n[14]||(n[14]=l=>o(e).options.outputBodyVariables=l),"on-create":G},{default:t(({index:l})=>[a(_,{align:"center"},{default:t(()=>[a(s,{"ignore-path-change":"","show-label":!1,"show-feedback":!1},{default:t(()=>[a(b,{modelValue:o(e).options.outputBodyVariables[l].path,"onUpdate:modelValue":p=>o(e).options.outputBodyVariables[l].path=p,placeholder:"Path",onKeydown:n[13]||(n[13]=U(N(()=>{},["prevent"]),["enter"]))},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),Ee,a(s,{"ignore-path-change":"","show-label":!1,"show-feedback":!1},{default:t(()=>[a(k,{value:o(e).options.outputBodyVariables[l].outputVariable,"onUpdate:value":p=>o(e).options.outputBodyVariables[l].outputVariable=p,placeholder:"Variable",options:o(I),clearable:"",filterable:"","on-search":o(A)},{empty:t(()=>[o(C).length?(i(),d(P,{key:0,dashed:"",onClick:p=>X(l)},{icon:t(()=>[a(pe,{type:"add"})]),default:t(()=>[g(" Create "+B(o(C)),1)]),_:2},1032,["onClick"])):V("",!0)]),_:2},1032,["value","onUpdate:value","options","on-search"])]),_:2},1024)]),_:2},1024)]),_:1},8,["value"])]),_:1})):(i(),d(s,{key:1,"show-feedback":!1,label:"Output raw data"},{default:t(()=>[a(b,{modelValue:o(e).options.outputRawVariable,"onUpdate:modelValue":n[15]||(n[15]=l=>o(e).options.outputRawVariable=l),placeholder:""},null,8,["modelValue"])]),_:1}))]),_:1})]),_:1})]),_:1})}}});export{So as default};
