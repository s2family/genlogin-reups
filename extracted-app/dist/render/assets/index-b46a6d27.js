import{S as U}from"./SignLayout-6118d152.js";import{a2 as A,aE as I,H as M,ah as D,aF as V,aG as N,a7 as q,am as H,aH as W,aI as Z,a5 as O}from"./main-8b08e1d6.js";import{e as F,_ as G}from"./crypto-ecc6ac78.js";import{d as K,b as R,r as X,a4 as Y,S as h,X as j,Y as r,L as J,u as e,U as x,V as d,D as o,E as p,$ as m,a1 as Q}from"./_plugin-vue_export-helper-b059e461.js";import{_ as ee}from"./Input-96fa4693.js";import{_ as se}from"./FormItem-52ed65a1.js";import{_ as ae}from"./Select-f7c79767.js";import{_ as te}from"./Form-e484375f.js";import"./Updater.vue_vue_type_script_setup_true_lang-91d65d78.js";import"./Progress-0b0a0198.js";import"./Layout-a5efc6cd.js";import"./lodash-6114c6d4.js";import"./axios-1e30d922.js";import"./xlsx-f5126985.js";import"./Suffix-fc59bb7a.js";const oe={key:0,class:"register-form"},ne={class:"flex justify-center flex-col signup-container"},le={class:"title"},re={class:"desc"},ie={class:"mt-24px"},ce={key:1,class:"p-45px active-layout"},ue={class:"active-container flex justify-center flex-col"},de={class:"title"},me={class:"desc"},pe={class:"mt-24px"},ge={class:"mt-24px"},_e=K({__name:"Signup",setup(fe){const{t}=A(),P=R(null),C=I(),b=M(),_={invalid:t("Common.Msg.InvalidData"),incorrect:t("Common.Msg.IncorrectData"),notmatch:t("Common.Msg.PasswordNotMatch")},k=[{label:t("Page.Register.Label.Phone"),value:"Phone"},{label:"Zalo",value:"Zalo"},{label:"Telegram",value:"Telegram"},{label:"Whatsapp",value:"Whatsapp"}],a=X({submitting:!1,email:"",password:"",rePassword:"",contactType:"Phone",contact:"",verifyToken:""}),S={email:{required:!0,trigger:"blur",validator:(l,s)=>{const n=/^\S+@\S+\.\S+$/;return new Promise((c,u)=>{s?n.test(s)?c():u(Error(_.incorrect)):u(Error(_.invalid))})}},password:{required:!0,trigger:"blur",validator:(l,s)=>new Promise((n,c)=>{s?n():c(Error(_.invalid))})},rePassword:{required:!0,trigger:"input",validator:(l,s)=>new Promise((n,c)=>{s?s!==a.password?c(Error(_.notmatch)):n():c(Error(_.invalid))})}},v=R(!1),T=async()=>{if(a.submitting)return;const{email:l,password:s,contact:n,contactType:c}=a;let u="",g="";["Phone","Zalo"].includes(c)?u=n:g=n;const w={email:l.trim(),password:s,phone_number:u,social_network:g};try{a.submitting=!0;const f=await W(w),{success:y}=f.data;y&&(v.value=!0,window.$message.success(t("Page.Register.Msg.RegisterSuccess")))}catch{}finally{a.submitting=!1}},E=async l=>{const s=await F(l);b.$patch({keepLogin:!0,keepLoginInfo:G(s)})},z=async()=>{const l={username:a.email.trim(),password:a.password};try{const s=await Z(l);if(s){const{data:n}=s.data;await E({username:a.email.trim(),password:a.password}),await b.setAccessToken(n.access_token,n.refresh_token),C.push({name:"main.profiles"}),window.$message.success(t("Page.Login.Msg.LoginSuccess")),await b.getAuth(),await O()}}catch{}finally{a.submitting=!1}},$=async()=>{if(!a.submitting)try{a.submitting=!0;const l={email:a.email,verify_token:a.verifyToken},s=await V(l),{success:n}=s.data;n&&(window.$message.info(t("Page.Register.Msg.EmailVerified")),await z())}catch{}finally{a.submitting=!1}};function B(l){var s;l.preventDefault(),(s=P.value)==null||s.validate(n=>{}),T()}return(l,s)=>{const n=N,c=q,u=ee,g=se,w=ae,f=H,y=te,L=Y("RouterLink");return h(),j(U,null,{default:r(()=>[J(l.$slots,"default",{},()=>[e(v)?(h(),x("div",ce,[d("div",{class:"breadcrumb cursor-pointer flex items-center",onClick:s[5]||(s[5]=i=>v.value=!1)},[o(D,{type:"back",class:"mr-8px",size:"large"}),d("div",null,m(e(t)("Page.Register.Label.BackToSignUp")),1)]),d("div",ue,[d("div",de,[o(n,{class:"mb-8px"},{default:r(()=>[p(m(e(t)("Page.Register.Label.ActivateCode")),1)]),_:1})]),d("div",me,[o(c,{depth:"3"},{default:r(()=>[p(m(e(t)("Page.Register.Label.CodeSent")),1)]),_:1})]),d("div",pe,[o(u,{value:e(a).verifyToken,"onUpdate:value":s[6]||(s[6]=i=>e(a).verifyToken=i),size:"large",placeholder:"Code"},null,8,["value"])]),o(f,{class:"btn-submit mt-16px",disabled:!e(a).verifyToken||e(a).submitting,loading:e(a).submitting,type:"primary",onClick:$},{default:r(()=>[p(m(e(t)("Common.Button.Submit")),1)]),_:1},8,["disabled","loading"]),d("div",ge,[p(m(e(t)("Page.Register.Label.AlreadyRegister"))+" ",1),o(L,{class:"text-blue-500",to:"signin"},{default:r(()=>[p(m(e(t)("Page.Register.Label.Login")),1)]),_:1})])])])):(h(),x("div",oe,[d("div",ne,[d("div",le,[o(n,{class:"mb-8px"},{default:r(()=>[p(m(e(t)("Page.Register.Label.Welcome")),1)]),_:1})]),d("div",re,[o(c,{depth:"3"},{default:r(()=>[p(m(e(t)("Page.Register.Label.SubTitle")),1)]),_:1})]),o(y,{ref_key:"formRef",ref:P,model:e(a),rules:S},{default:r(()=>[o(g,{size:"large",class:"mt-24px",label:e(t)("Common.Label.Email"),path:"email"},{default:r(()=>[o(u,{value:e(a).email,"onUpdate:value":s[0]||(s[0]=i=>e(a).email=i),size:"large",placeholder:e(t)("Common.Label.Email")},null,8,["value","placeholder"])]),_:1},8,["label"]),o(g,{size:"large",label:e(t)("Common.Label.Password"),path:"password"},{default:r(()=>[o(u,{value:e(a).password,"onUpdate:value":s[1]||(s[1]=i=>e(a).password=i),size:"large",type:"password","show-password-on":"mousedown",placeholder:e(t)("Common.Label.Password")},null,8,["value","placeholder"])]),_:1},8,["label"]),o(g,{size:"large",label:e(t)("Page.Register.Label.ConfirmPassword"),path:"rePassword"},{default:r(()=>[o(u,{value:e(a).rePassword,"onUpdate:value":s[2]||(s[2]=i=>e(a).rePassword=i),size:"large",type:"password","show-password-on":"mousedown",placeholder:e(t)("Page.Register.Label.ConfirmPassword"),disabled:!e(a).password},null,8,["value","placeholder","disabled"])]),_:1},8,["label"]),o(g,{size:"large",label:e(t)("Page.Register.Label.Contact"),path:"phone"},{default:r(()=>[o(w,{size:"large","default-value":k[0].value,class:"w-1/2 mr-8px",options:k,"onUpdate:value":s[3]||(s[3]=i=>{e(a).contactType=i})},null,8,["default-value"]),o(u,{value:e(a).contact,"onUpdate:value":s[4]||(s[4]=i=>e(a).contact=i),size:"large",type:"text",placeholder:"+8412345678"},null,8,["value"])]),_:1},8,["label"]),o(f,{class:"btn-submit",loading:e(a).submitting,disabled:e(a).submitting,type:"primary",onClick:B},{default:r(()=>[p(m(e(t)("Common.Button.Submit")),1)]),_:1},8,["loading","disabled"])]),_:1},8,["model"]),d("div",ie,[p(m(e(t)("Page.Register.Label.AlreadyRegister"))+" ",1),o(L,{class:"text-blue-500",to:"signin"},{default:r(()=>[p(m(e(t)("Page.Register.Label.Login")),1)]),_:1})])])]))],!0)]),_:3})}}});const $e=Q(_e,[["__scopeId","data-v-3515be36"]]);export{$e as default};
