import{a2 as B,bZ as M,Z as k,am as V,aL as $,a9 as I}from"./main-8b08e1d6.js";import{u as L}from"./uniqBy-ee48ba02.js";import{d as N,b as p,c as z,w as D,m as H,S as O,X as R,Y as r,V as b,$ as v,u as o,D as m,E as P,q as Z,t as j}from"./_plugin-vue_export-helper-b059e461.js";import{_ as q}from"./Select-f7c79767.js";import"./lodash-6114c6d4.js";import"./axios-1e30d922.js";import"./xlsx-f5126985.js";import"./_baseUniq-35fed69a.js";import"./Suffix-fc59bb7a.js";const E={class:"d-flex flex-row mt-3 mb-2 align-items-center"},oe=N({__name:"AssignProfilesToGroupsModal",props:{modelShow:{type:Boolean,default:!1},ids:{type:Array,default:()=>[]}},emits:["update:modelShow","success"],setup(w,{emit:y}){const h=w,{t:l}=B(),u=p(!1),c=p(!1),n=p(null),i=p([]),{defaultParams:G,pagination:f}=L(),S=z(()=>i.value.map(e=>({label:e.name,value:e.id}))),_=async(e={offset:0,limit:100})=>{if(!c.value&&i.value.length!==f.value.total_items)try{c.value=!0;const{limit:s,offset:a}=e,t=await M(Object.assign(G.value,{offset:a,limit:s})),{data:d}=t.data;i.value=[...i.value,...d.items],f.value=d.pagination}catch{i.value=[]}finally{c.value=!1}},C=async e=>{const{limit:s,next_offset:a}=f.value,t=e.currentTarget;a&&t.scrollTop+t.offsetHeight>=t.scrollHeight-20&&await _({limit:s,offset:a})},g=()=>{n.value=null,y("update:modelShow",!1)},x=async()=>{if(!n.value){window.$message.warning(l("Page.Profiles.Msg.SelectGroup"));return}try{u.value=!0;const e=j(h.ids);await k(n.value,{add_profile_ids:e}),window.$message.success(l("Page.Profiles.Msg.ProfileAssigned")),g()}catch{}finally{u.value=!1}};return D(()=>h.modelShow,e=>{e?_():i.value=[]}),H(()=>{_()}),(e,s)=>{const a=V,t=$,d=q,T=I;return O(),R(T,{show:w.modelShow,"transform-origin":"center",preset:"dialog",onClose:g},{header:r(()=>[b("div",null,v(o(l)("Page.Profiles.Label.AssignToGroup")),1)]),action:r(()=>[m(t,null,{default:r(()=>[m(a,{size:"small",disabled:o(u),onClick:g},{default:r(()=>[P(v(o(l)("Common.Button.Cancel")),1)]),_:1},8,["disabled"]),m(a,{size:"small",type:"success",disabled:o(u),loading:o(u),onClick:x},{default:r(()=>[P(v(o(l)("Page.Profiles.Actions.Assign")),1)]),_:1},8,["disabled","loading"])]),_:1})]),default:r(()=>[b("div",E,[m(d,{value:o(n),"onUpdate:value":s[0]||(s[0]=A=>Z(n)?n.value=A:null),loading:o(c),options:o(S),filterable:"",placeholder:o(l)("Common.Label.Group"),onScroll:C},null,8,["value","loading","options","placeholder"])])]),_:1},8,["show"])}}});export{oe as default};
