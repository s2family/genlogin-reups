import{bZ as y,b_ as w,ah as b,am as V}from"./main-8b08e1d6.js";import{b as c,c as $,d as S,m as x,f as C,S as g,X as v,Y as f,u as i,D as N,E as k,$ as T,a2 as O,P}from"./_plugin-vue_export-helper-b059e461.js";import{_ as B}from"./Select-f7c79767.js";const D=()=>{const a=c([]),n=c(!1),l=c({limit:25,offset:0,order:"desc",sort_by:"id",search:""}),u=c({page:1,limit:25,current_offset:0,next_offset:0,total_items:0}),p=$(()=>a.value.map(e=>({label:e.name,value:e.id}))),s=async(e={offset:0,limit:25})=>{if(!n.value)try{n.value=!0;const{limit:o,offset:r}=e,t=await y(Object.assign(l.value,{offset:r,limit:o})),{data:m}=t.data;a.value=[...a.value,...m.items],u.value=m.pagination}catch{a.value=[]}finally{n.value=!1}};return{groups:a,groupOptions:p,getGroups:s,createGroup:async e=>{const o=await w(e);return a.value=[],await s(),window.$message.success(`Group ${e} created!`),o.data.data.id},handleScroll:async e=>{const{limit:o,next_offset:r}=u.value,t=e.currentTarget;t.scrollTop+t.offsetHeight>=t.scrollHeight-20&&await s({limit:o,offset:r})}}},z=S({__name:"SelectGroups",props:{modelValue:{type:Number,default:null}},emits:["update:modelValue"],setup(a,{emit:n}){const{groups:l,groupOptions:u,handleScroll:p,getGroups:s,createGroup:_}=D(),d=t=>n("update:modelValue",t),e=c(""),o=t=>{e.value=t},r=async()=>{const t=await _(e.value);d(t),e.value=""};return x(async()=>{l.value=[],await s()}),C(async()=>{l.value=[],await s()}),(t,m)=>{const h=V,G=B;return g(),v(G,P({size:"large"},t.$attrs,{clearable:"",filterable:"",options:i(u),"on-scroll":i(p),value:a.modelValue,"on-search":o,onUpdateValue:d}),{empty:f(()=>[i(e).length?(g(),v(h,{key:0,dashed:"",onClick:r},{icon:f(()=>[N(b,{type:"add"})]),default:f(()=>[k(" Create group "+T(i(e)),1)]),_:1})):O("",!0)]),_:1},16,["options","on-scroll","value"])}}});export{z as _};
