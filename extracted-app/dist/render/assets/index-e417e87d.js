import{d as F,r as L,b as V,m as B,S as p,X as m,Y as a,V as r,D as s,$ as l,u as o,af as v,E as f,a2 as I,a1 as N}from"./_plugin-vue_export-helper-b059e461.js";import{S as $}from"./SignLayout-6118d152.js";import{a2 as T,G as q,ah as M,aJ as P,aK as R,al as U,am as D,aL as j,a7 as z,ao as E}from"./main-8b08e1d6.js";import{_ as G}from"./Input-96fa4693.js";import{_ as J}from"./FormItem-52ed65a1.js";import{_ as K}from"./Form-e484375f.js";import"./Updater.vue_vue_type_script_setup_true_lang-91d65d78.js";import"./Progress-0b0a0198.js";import"./Layout-a5efc6cd.js";import"./lodash-6114c6d4.js";import"./axios-1e30d922.js";import"./xlsx-f5126985.js";import"./Suffix-fc59bb7a.js";const X={class:"p-45px forgot-layout"},Y={class:"forgot-container flex justify-center flex-col"},A={class:"title mb-8px"},H={class:"block"},O={class:"block"},Q=F({__name:"ForgotPassword",setup(W){const{t:n}=T(),{router:h}=q(),e=L({step:"verify",submitting:!1,email:"",verifyCode:"",newPassword:""}),_=V(null),g=()=>{h.push({name:"signin"})},C=async()=>{const c={email:e.email};try{e.submitting=!0;const t=await R(c);if(t){const{success:i}=t.data;i&&(e.step="change-password")}}catch{}finally{e.submitting=!1}},k=async()=>{const c={email:e.email,old_password:e.verifyCode,new_password:e.newPassword};try{e.submitting=!0;const t=await U(c);if(t){const{success:i,data:d}=t.data;i?(window.$message.success(n("Page.ForgotPassword.Msg.PasswordChanged")),g()):window.$message.error(d)}}catch{}finally{e.submitting=!1}};return B(()=>{_.value.focus()}),(c,t)=>{const i=G,d=J,w=D,b=j,y=K,S=z,x=E;return p(),m($,null,{default:a(()=>[r("div",X,[r("div",{class:"breadcrumb cursor-pointer flex items-center",onClick:g},[s(M,{type:"back",class:"mr-8px",size:"large",color:"#8c8c8c"}),r("div",null,l(o(n)("Page.ForgotPassword.Label.BackToSignIn")),1)]),r("div",Y,[r("div",A,l(o(n)("Page.ForgotPassword.Label.Title")),1),s(x,{show:o(e).submitting},{default:a(()=>[o(e).step==="verify"?(p(),m(y,{key:0,id:"form-forgot",onSubmit:v(C,["prevent"])},{default:a(()=>[s(d,{label:o(n)("Page.ForgotPassword.Label.SubTitle")},{default:a(()=>[s(i,{ref_key:"firstInputRef",ref:_,value:o(e).email,"onUpdate:value":t[0]||(t[0]=u=>o(e).email=u),required:"",placeholder:"","allow-input":o(P)},null,8,["value","allow-input"])]),_:1},8,["label"]),s(b,{vertical:""},{default:a(()=>[r("div",H,[s(w,{"attr-type":"submit",type:"primary",block:"",strong:"",disabled:o(e).submitting},{default:a(()=>[f(l(o(n)("Common.Button.Submit")),1)]),_:1},8,["disabled"])])]),_:1})]),_:1},8,["onSubmit"])):o(e).step==="change-password"?(p(),m(y,{key:1,id:"form-forgot",onSubmit:v(k,["prevent"])},{default:a(()=>[s(S,null,{default:a(()=>[f(l(o(n)("Page.ForgotPassword.Label.VerifyCodeSent"))+" ",1),r("strong",null,l(o(e).email),1)]),_:1}),s(d,{class:"mt-2",label:"Verify code"},{default:a(()=>[s(i,{ref_key:"firstInputRef",ref:_,value:o(e).verifyCode,"onUpdate:value":t[1]||(t[1]=u=>o(e).verifyCode=u),required:"",placeholder:"","allow-input":o(P)},null,8,["value","allow-input"])]),_:1}),s(d,{label:o(n)("Page.ForgotPassword.Label.NewPassword")},{default:a(()=>[s(i,{value:o(e).newPassword,"onUpdate:value":t[2]||(t[2]=u=>o(e).newPassword=u),type:"password",required:"",placeholder:""},null,8,["value"])]),_:1},8,["label"]),s(b,{vertical:""},{default:a(()=>[r("div",O,[s(w,{"attr-type":"submit",type:"primary",block:"",strong:"",disabled:o(e).submitting},{default:a(()=>[f(l(o(n)("Common.Button.ChangePassword")),1)]),_:1},8,["disabled"])])]),_:1})]),_:1},8,["onSubmit"])):I("",!0)]),_:1},8,["show"])])])]),_:1})}}});const _e=N(Q,[["__scopeId","data-v-9b9aceea"]]);export{_e as default};
